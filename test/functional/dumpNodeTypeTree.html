<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>x3dom nodetypes</title>
    <!-- BEGIN:X3DOM -->
<meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge" />
<link rel="stylesheet" type="text/css" href="../../src/x3dom.css" />
<script type="text/javascript" src="../../src/lang/Array.js"></script>
<script type="text/javascript" src="../../src/Internals.js"></script>
<script type="text/javascript" src="../../src/debug.js"></script>
<script type="text/javascript" src="../../src/util/DownloadManager.js"></script>
<script type="text/javascript" src="../../src/util/RefinementJobManager.js"></script>
<script type="text/javascript" src="../../src/util/RefinementJobWorker.js"></script>
<script type="text/javascript" src="../../src/util/Properties.js"></script>
<script type="text/javascript" src="../../src/util/DoublyLinkedList.js"></script>
<script type="text/javascript" src="../../src/util/EarClipping.js"></script>
<script type="text/javascript" src="../../src/util/Utils.js"></script>
<script type="text/javascript" src="../../src/util/States.js"></script>
<script type="text/javascript" src="../../src/util/BinaryContainerSetup.js"></script>
<script type="text/javascript" src="../../src/util/DrawableCollection.js"></script>
<script type="text/javascript" src="../../src/X3DCanvas.js"></script>
<script type="text/javascript" src="../../src/Runtime.js"></script>
<script type="text/javascript" src="../../src/Main.js"></script>
<script type="text/javascript" src="../../src/Cache.js"></script>
<script type="text/javascript" src="../../src/Texture.js"></script>
<script type="text/javascript" src="../../src/shader/Shader.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderParts.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderDynamic.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderDynamicMobile.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderComposed.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderNormal.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderPicking.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderPicking24.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderPickingColor.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderPickingTexcoord.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderFrontgroundTexture.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderBackgroundTexture.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderBackgroundSkyTexture.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderBackgroundCubeTexture.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderShadow.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderShadowRendering.js"></script>
<script type="text/javascript" src="../../src/shader/ShaderBlur.js"></script>
<script type="text/javascript" src="../../src/gfx_webgl.js"></script>
<script type="text/javascript" src="../../src/gfx_flash.js"></script>
<script type="text/javascript" src="../../src/X3DDocument.js"></script>
<script type="text/javascript" src="../../src/MatrixMixer.js"></script>
<script type="text/javascript" src="../../src/Viewarea.js"></script>
<script type="text/javascript" src="../../src/Mesh.js"></script>
<script type="text/javascript" src="../../src/fields.js"></script>
<script type="text/javascript" src="../../src/nodes/NodeNameSpace.js"></script>
<script type="text/javascript" src="../../src/nodes/Core.js"></script>
<script type="text/javascript" src="../../src/nodes/Grouping.js"></script>
<script type="text/javascript" src="../../src/nodes/Bindable.js"></script>
<script type="text/javascript" src="../../src/nodes/Rendering.js"></script>
<script type="text/javascript" src="../../src/nodes/Shape.js"></script>
<script type="text/javascript" src="../../src/nodes/Lighting.js"></script>
<script type="text/javascript" src="../../src/nodes/Followers.js"></script>
<script type="text/javascript" src="../../src/nodes/Interpolation.js"></script>
<script type="text/javascript" src="../../src/nodes/Time.js"></script>
<script type="text/javascript" src="../../src/nodes/Networking.js"></script>
<script type="text/javascript" src="../../src/nodes/EnvironmentalEffects.js"></script>
<script type="text/javascript" src="../../src/nodes/Navigation.js"></script>
<script type="text/javascript" src="../../src/nodes/Text.js"></script>
<script type="text/javascript" src="../../src/nodes/Sound.js"></script>
<script type="text/javascript" src="../../src/nodes/Texturing.js"></script>
<script type="text/javascript" src="../../src/nodes/Shaders.js"></script>
<script type="text/javascript" src="../../src/nodes/Geometry3D.js"></script>
<script type="text/javascript" src="../../src/nodes/Texturing3D.js"></script>
<script type="text/javascript" src="../../src/nodes/Geospatial.js"></script>
<script type="text/javascript" src="../../src/nodes/Geometry2D.js"></script>
<script type="text/javascript" src="../../src/nodes/VolumeRendering.js"></script>
<script type="text/javascript" src="../../src/Docs.js"></script>
<!-- END:X3DOM -->

    <!-- BEGIN:TEST -->
    <script type="text/javascript" src="media/js/tests.js"></script>
    <!-- END:TEST -->
    
    <style>
    .FIELD {
        font-size: small;
        color: saddlebrown;
        margin: 10px;
    }
    </style>
	</head>
       
<body>

    <h1 style='color:darkblue;'>X3DOM Node Types</h1>
	<div>
	   The <a href="#_types">node type tree</a> shows the complete node hierarchy, 
	   whereas the <a href="#_components">components</a> list below also shows the nodes' fields.
	</div>
    <br />
    <hr />
    
    <a name="_types"></a>
    <h1 style='color:darkblue;'>X3DOM node type tree</h1>
	<div id="types"></div>
    <br />
    <hr />
    
    <a name="_components"></a>
    <h1 style='color:darkblue;'>Node types by component</h1>
    <div id="components"></div>
    <br />
    <hr />
  
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript">
    
        function objInArray(array, obj) {
            for(var i=0; i<array.length; i++) {
                if (array[i] === obj) {
                    return true;
                }
            }
            return false;
        }
        
        var urlMap = {
            CADGeometry: "CADGeometry.html",
            Core: "core.html",
            DIS: "dis.html",
            CubeMapTexturing: "env_texture.html",
            EnvironmentalEffects: "enveffects.html",
            EnvironmentalSensor: "envsensor.html",
            Followers: "followers.html",
            Geospatial: "geodata.html",
            Geometry2D: "geometry2D.html",
            Geometry3D: "geometry3D.html",
            Grouping: "group.html",
            //H-Anim: "hanim.html",
            Interpolation: "interp.html",
            KeyDeviceSensor: "keyboard.html",
            Layering: "layering.html",
            Layout: "layout.html",
            Lighting: "lighting.html",
            Navigation: "navigation.html",
            Networking: "networking.html",
            NURBS: "nurbs.html",
            ParticleSystems: "particle_systems.html",
            Picking: "picking.html",
            PointingDeviceSensor: "pointingsensor.html",
            Rendering: "rendering.html",
            RigidBodyPhysics: "rigid_physics.html",
            Scripting: "scripting.html",
            Shaders: "shaders.html",
            Shape: "shape.html",
            Sound: "sound.html",
            Text: "text.html",
            Texturing3D: "texture3D.html",
            Texturing: "texturing.html",
            Time: "time.html",
            EventUtilities: "utils.html",
            VolumeRendering: "volume.html"
        };
        urlMap["H-Anim"] = "hanim.html";    //due to "-" in name
        
        var baseUrl = "http://www.web3d.org/x3d/specifications/ISO-IEC-19775-1.2-X3D-AbstractSpecification/Part01/components/";
        
        
        function dumpType(t, indent) {
            for (var i=0; i<indent; i++) {
                $("#types").append("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
            }
            
            $("#types").append("<a href='" + 
                baseUrl + urlMap[x3dom.nodeTypes[t]._compName] + "#" + t + 
                "' style='color:black; text-decoration:none; font-weight:bold;'>" + 
                t + "</a> &nbsp; <a href='" + 
                baseUrl + urlMap[x3dom.nodeTypes[t]._compName] + 
                "' style='color:black; text-decoration:none; font-style:italic;'>" + 
                x3dom.nodeTypes[t]._compName + "</a><br/>");
            
            for (var i in x3dom.nodeTypes[t].childTypes[t]) {
                dumpType(x3dom.nodeTypes[t].childTypes[t][i], indent+1); 
            }
        }        
        
        function dumpFields(t, elem) {
            var instance = new x3dom.nodeTypes[t];
            var isMultiField = false;
            var fieldInfo = "<li><table cellspacing='1' cellpadding='1' border='1' class='FIELD'>";
            
            fieldInfo += "<tr align='left'><th>DataType</th><th>Name</th><th>DefaultValue</th></tr>";
            
            for (var fieldName in instance._vf) {
                isMultiField = (instance._vfFieldTypes[fieldName].charAt(0) == "M");
    			var fieldValue = isMultiField ? "[" : "";
    			
    			if (instance._vf[fieldName].toGL)
		            fieldValue += instance._vf[fieldName].toGL().toString();
		        else if (instance._vfFieldTypes[fieldName] == "MFString") {
		            for (var k=0; k<instance._vf[fieldName].length; k++)
		                if (k == instance._vf[fieldName].length - 1)
		                    fieldValue += instance._vf[fieldName][k];
		                else
		                    fieldValue += (instance._vf[fieldName][k] + ", ");
	            }
		        else
		            fieldValue += instance._vf[fieldName].toString();
		        
		        fieldValue += (isMultiField ? "]" : "");
		        if (fieldValue.length == 0)
		            fieldValue = "&nbsp;";
		        
		        fieldInfo += "<tr><td>" + instance._vfFieldTypes[fieldName] + "</td><td>" + 
		                     fieldName + "</td><td>" + fieldValue + "</td></tr>";
    		}
    		
            for (var fieldName in instance._cf) {
                isMultiField = (instance._cfFieldTypes[fieldName].charAt(0) == "M");
                if (isMultiField)
                    fieldValue = "[]";
                else
                    fieldValue = "NULL";
                
		        fieldInfo += "<tr><td>" + instance._cfFieldTypes[fieldName] + "</td><td>" +  
		                     fieldName + "</td><td>" + fieldValue + "</td></tr>";
    		}
    		
    		fieldInfo += "</table></li>";
    		
    		elem.append(jQuery(fieldInfo));
        }
                        
        $(document).ready( function() {

            // Create the nodetype hierarchy
            for (var tn in x3dom.nodeTypes) {
                var t = x3dom.nodeTypes[tn];
                
                if (t.childTypes === undefined)
                    t.childTypes = {};
                
                while (t.superClass) {     
                    if (t.superClass.childTypes[t.superClass._typeName] === undefined) {
                        t.superClass.childTypes[t.superClass._typeName] = [];
                    }
                    if (!objInArray(t.superClass.childTypes[t.superClass._typeName], t._typeName)) {
                        t.superClass.childTypes[t.superClass._typeName].push(t._typeName);
                    }
                    t = t.superClass;
                }
            }            
            
            /*
            var iexplore = (navigator.userAgent.indexOf("MSIE") != -1);
            
            if (iexplore) {
                document.write("Sorry, but Internet Explorer does not yet support advanced scripting.");
                document.write("<br\>Please use a WebKit or Gecko based web browser like Firefox etc.");
            }
            else */
            {
                // Dump the nodetype hierachy
                dumpType("X3DNode", 0); 
                
                
                // Dump nodetypes by component
                // but first sort alphabetically
                var components = [];
                for (var c in x3dom.components) {
                    components.push(c);
                }
                components.sort();
                
                for (var cn in components) {
                    var c = components[cn];
                    var component = x3dom.components[c];
                    $("#components").append("<h2 style='margin-top: 40px;'><a href='" + 
                        baseUrl + urlMap[c] +
                        "' style='color:green; text-decoration:none; font-style:italic; font-weight:bold;'>" + 
                        c + "</a></h2>");
                    
                    $("#components").append("<ul style='list-style-type:circle;'>");
                    
                    var $ul = $("#components ul:last");
                    for (var t in component) {
                        $ul.append("<li><a href='" + 
                            baseUrl + urlMap[c] + "#" + t + 
                            "' style='color:black; text-decoration:none; font-weight:bold;'>" + 
                            t + "</a></li>");
                        
                        dumpFields(t, $ul); 
                    }
                }
            }
        });
    </script>
    
</body>
</html>
