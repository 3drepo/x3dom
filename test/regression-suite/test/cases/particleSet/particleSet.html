<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="http://www.x3dom.org/download/x3dom.css"/>
    <script type="text/javascript" src="../../../../x3dom_include.js"></script>
    <title>ParticleSet</title>
</head>
<body>
<x3d width="800px" height="600px" id="x3d">
    <scene>
        <Background></Background>
        <Transform id="trans">
            <Shape id="shape">
                <Appearance>
                    <Material diffuseColor="0 1 0.2"></Material>
                    <DepthMode readOnly='true'></DepthMode>
                </Appearance>
                <ParticleSet id="ps" drawOrder='backToFront' size="1 1 1, 1 1 1, 1 1 1">
                    <Coordinate point='0 0 0, 1 1 1, 2 2 2'></Coordinate>
                    <Color color='1 1 0, 1 1 0, 1 1 0'></Color>
                </ParticleSet>
            </Shape>
        </Transform>
    </scene>
</x3d>

<div>
    <br><input type="button" value="Change" onclick="changeParticles();">
</div>

<script type="text/javascript">
	document.onload = function()
	{
		var ps = document.getElementById("ps");
        ps.setAttribute("mode", "ViewDirQuads");
        ps.setFieldValue("mode", "Points");

        var ref = ps.requestFieldRef("mode");
        console.log(ref);
        ref = "ViewDirQuads";   // Attention, cannot work, is primitive data type, fix in source!
        ps.releaseFieldRef("mode");

        console.log(ps._x3domNode._vf.mode);
        ps.setAttribute("mode", "ViewDirQuads");
	};

    function changeParticles()
    {
        var mat = document.getElementsByTagName("Color");
        mat[0].setAttribute("color", '0 1 0, 0 0 1, 1 0 0, 1 1 1');

        var pnt = document.getElementsByTagName("Coordinate");
        pnt[0].setAttribute("point", '0 1 1, 2 2 2, 3 2 2, -1 -1 -1');

        var ps = document.getElementById("ps");
        ps.setAttribute("size", '3 3 3, 2 2 2, .5 .5 .5, 1 1 1');
    }
</script>
</body>
</html>